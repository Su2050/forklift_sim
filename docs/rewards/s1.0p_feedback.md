我先按“读出来的事实 → 解释这些事实意味着什么 → 下一步怎么打破瓶颈”的顺序，把这次 S1.0P 讲清楚；然后给你一份**我希望你补充给我的资料清单**，这样下一轮（S1.0Q）就能从“凭感觉调参”升级为“用证据驱动的迭代”。 

---

## 1) 这次实验最关键的结论是什么？

### A. **“成功率卡住”不是 hold 机制的锅**

你在 S 组（S1/S2/S3）改了 hold_counter_decay、hysteresis_ratio、steer_smooth 惩罚，但 `frac_success` 基本都在噪声里晃（B0≈0.0031，几组变化量都在 1e-4 量级），完全达不到你设的验收门槛。与此同时，B0 的 `hold_counter_max≈9.76` 已经非常接近阈值 10，说明：**一旦进了 hold 条件，策略“差一点就能站稳”**；真正稀缺的是“进入那个条件”的频率。 

> 翻译成人话：你不是“站不稳”，你是“很少站上去”。

---

### B. **Yaw 的小幅改善能做出来，但不稳定、不可复现**

* P1（k_hold_align 0.3→0.6）在 seed=42 下 `yaw_near` 提升了约 **-0.28°**，而且 `r_hold_align` 的量级确实翻倍，说明机制在工作。
* 但 seed=2026 下方向反了（`yaw_near` 反而 +0.18°），所以这类改动目前属于**高方差、靠运气出图**的类型。 

> 这就是典型的：信号存在，但不足以压住 PPO 里的随机性与其它更强奖励项的梯度。

---

### C. **P2b 是目前“最像真赢家”的候选，但缺少 seed 验证**

P2b（更强收紧 gate3：12°/0.18m → 6°/0.10m）做到：

* `yaw_near` 约 **-0.20°**（踩线达标）
* `yaw_deep` 训练内趋势 **-0.32°**（全实验最强）
* `yaw_deep_p90` 也更低
  而且 `deep_frac` 的趋势还不错。唯一的问题：**没做 seed 复验**。 

---

### D. **X1 的“短期变好、长期回退”非常重要：它像在告诉你“结构性瓶颈”**

X1（新增近场 yaw delta shaping，k=0.5, sigma=4°）在 300 iter 有信号，但拉长到 X1ext 后出现：

* early 最好 `yaw_deep` 触到 **4.75°**（历史最佳）
* 后面又回到 ~5.15°、`yaw_near` 也回退
  这特别像：**策略短暂学会“更精”的对齐，但最终发现另一条总体回报更高/更容易的路径，于是把精细对齐‘遗忘/放弃’了**。 

---

## 2) 我对“卡住原因”的判断（把你的四个假设再“咬紧”一点）

你报告里给了四个结构性假设（观测分辨率 / 奖励淹没 / 网络干扰 / 课程缺失）。我基本同意，而且我会把它们合并成一个更“可操作”的因果链：

**观测分辨率不够** + **近场对齐奖励占比太小**
→ 近场“5° vs 6°”在网络眼里差别不够大、在总回报里也不够重要
→ PPO 更新主要被“更常见、更大额”的远场推进/插入相关梯度牵着走
→ 偶尔能学到精对齐（像 X1ext early 那样），但会被后续训练冲掉（回到 ~5.5–5.8° 的均衡点） 

我还想额外点名一个“隐藏 Boss”：

### **E. 你可能低估了 lateral 的贡献**

B0 的 `lateral_near≈0.317m` 这个数本身不小；而你在 P2b 里收紧了 `y_gate3` 到 0.10m，但 `lateral_near` 并没有同步变好。也就是说：**就算 yaw 再抠 0.2°，如果 lateral 仍然是主要超标项，成功率也不一定动**。
但这里我不敢下死结论，因为我还不知道 `lateral_near_success` 的统计口径、以及 success/grace zone 对 y 的硬阈值到底是多少。 

---

## 3) 下一步最该做什么（S1.0Q 的“最短路径”）

我给你一个按“信息增益/工程成本比”排序的路线——尽量先做**能快速排除/确认**的事，再上大改。

### Step 1：先把 P2b 做 seed 复验（并且别只跑 1 个种子）

你已经被 P1 教训过一次：单 seed 的 -0.28° 可能只是随机波动。
所以 P2b 我建议至少做 **3 个 seed**（比如 42/2026/再挑一个常用 seed），看改善方向是否一致、幅度是否稳定。 

> 只要 P2b 在多 seed 下仍然能把 yaw_deep 趋势压下来，它就值得成为“新的 baseline 结构”。

---

### Step 2：把“成功率”拆解成漏斗，确认到底卡在 yaw 还是 lateral（或两者的交集）

你现在已经知道：near_success 很高（~60%），deep_insert 也不低（~40%），但 success 极低（~0.3%），grace_zone 也极低（~0.57%）。这强烈暗示：**瓶颈在“进 grace zone 的概率”**。 

下一步我会做一个“漏斗表”——不是看均值，而是看概率：

* `P(insert_norm > 0.1)`（你已有 near_frac）
* `P(insert_norm > 0.3)`（你已有 deep_frac）
* `P(insert_norm > 0.1 AND |yaw|<5°)`
* `P(insert_norm > 0.1 AND |y|<y_thresh)`
* `P(insert_norm > 0.1 AND |yaw|<5° AND |y|<y_thresh)`（这基本就是 grace zone 的核心）
* 以及这些事件发生时的**停留步数分布**（对应 hold_counter 能不能攒到 10）

这一步会直接告诉你：**到底是 yaw 还是 lateral 先卡死**，以及你需要的是“把均值抠一点”还是“把分布的尾巴往里拖”。（很多时候成功率不涨，是因为你改的是均值，但门槛吃的是分位数/尾部。）

---

### Step 3：近场奖励“别再当背景音乐”，要让它进主旋律（但要加护栏）

你报告里已经算过量级：`r_hold_align ~3e-4`、`r_yaw_fine ~8e-4`，而主导项在 1e-2 到 1e-1。换句话说：你现在的 yaw/lateral shaping 像是在摇滚音乐节里小声背单词，没人听得见。 

我建议的方向不是盲目把 k 加到爆（X2 已经证明会翻车），而是**“分场景配比”**：

* 当 `insert_norm` 进入近场（比如 >0.08 或 >0.1）：

  * **下调**推进类 shaping（比如 r_pot 的权重或某些 dense penalty 的权重）
  * **上调**对齐类 shaping（yaw + lateral），让对齐在近场的回报占比能到 **10–20%**（你的假设 B 很合理）
* 同时加护栏指标：

  * `deep_frac` 不能掉
  * `insert_norm_mean` 不能断崖
  * 以及“近场停留时间”不能暴涨（防止策略学会原地磨蹭刷 reward）

这种“近场 reweight”通常比“全局增大 k”更稳，因为它减少了 reward 之间的互相打架。

---

### Step 4：观测分辨率升级（这是最可能的“硬突破点”）

你对 cos/sin 在小角度变化很小的分析是到位的。只要网络“看不清 5° 和 6°”，你再怎么加小奖励，它也很难学得稳定。 

我会优先加两类观测（都非常便宜）：

* `yaw_err_deg` 的高分辨率归一化版本（比如 /10°）
* `lateral_err` 的高分辨率归一化版本（比如 /0.3m 或 /0.2m，取决于你的门槛）

然后要么：

* 重新训一个新模型（最干净），要么
* 做“兼容 warm start”的权重加载（把新增维度的第一层权重初始化为 0，尽量不破坏旧策略）

---

### Step 5：课程学习（Yaw/横向门槛分阶段收紧）

你现在是硬门槛 5°，但策略均衡点在 5.5–5.8° 附近。课程学习的作用就是：**把“跨不过去的坎”改成“台阶”**。 

做法可以很朴素：先让 success 认可 7°，稳定后再改成 6°，最后回到 5°。
关键点在于：每一级台阶都要能显著提高 `grace_zone_frac`，否则就不是台阶，是空气墙。

---

## 4) 为了我能更精确指导下一步，你可以再发我哪些东西？

你现在这份总结已经很强了；如果你愿意再补几样“关键证据”，我就能把建议从“方向性”变成“明确改哪里、怎么改、怎么验收”。

### (1) **成功/Grace zone/Hold 的精确定义（代码或伪代码）**

包括：

* success 的 yaw/y/insert/速度等阈值
* grace zone 的判定条件
* hold_counter 的更新规则（进入/退出、衰减、hysteresis 的具体逻辑）
* hold_steps=10 的位置与含义

> 这是定位“到底卡在哪个门槛”的核心。

---

### (2) **15 维观测向量的逐维说明（名称 + 归一化尺度）**

你在报告里提到了 `cos(dyaw)`, `sin(dyaw)`, `yaw_err_obs` 等，但我需要完整清单：

* 每一维是什么
* 量纲和归一化怎么做
* 有没有裁剪/饱和（clip）

> 这决定了“分辨率不足”到底是不是主因，以及怎么补观测最有效。

---

### (3) **奖励函数各分量：每回合 sum/mean 的日志（最好能导出 CSV）**

你已经有分量量级的均值对比了，我还想看：

* 按 episode 的 reward 分解（sum 更关键，mean 有时会骗你）
* 近场区间（insert_norm>0.1）条件下的分解
* `r_pot`、`r_milestone`、`pen_dense`、`r_hold_align`、`r_yaw_fine` 的方差/分位数

> 这是验证“奖励淹没”与“近场被远场梯度冲掉”的证据。

---

### (4) **关键指标的分布，而不只是 last50 均值**

最有用的是：

* `yaw`、`lateral` 在 `insert_norm>0.1` 时的直方图/分位数（p50/p75/p90/p95）
* `yaw_deep_p90` 你已经有了，很棒；我还想要 `yaw_near_p90`、`lateral_near_p90`
* `hold_counter_max` 的分布（不是均值）：有多少 episode 卡在 7–9？有多少是 0？

> 成功率是门槛函数，均值改善不等于过门槛概率改善。

---

### (5) **两三段代表性 rollout（最好是视频或逐步日志）**

各来一段：

* “接近顺利但最后不成功”
* “进入 grace zone 但 hold 失败”
* “真正成功的”（哪怕很少）

> 很多 bug/漏洞/可利用路径，只有看行为序列才能一眼识破。

---

## 5) 一句话总结（把刀磨利）

S1.0P 已经很明确地告诉我们：**小修小补的 reward 参数，很难稳定把 yaw 从 ~5.7° 推过 5° 门槛，更别说把 success 拉起来**；你现在最值钱的动作是：**用 seed 复验锁定 P2b 是否真实有效 + 用漏斗分解查清到底是 yaw 还是 lateral（或它们的交集）在掐住 grace zone**，然后针对近场做“观测分辨率 + 奖励配比”的结构性升级。 
